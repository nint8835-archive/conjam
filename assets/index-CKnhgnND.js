var Bt=Object.defineProperty;var jt=(t,e,n)=>e in t?Bt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var W=(t,e,n)=>(jt(t,typeof e!="symbol"?e+"":e,n),n),pt=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var J=(t,e,n)=>(pt(t,e,"read from private field"),n?n.call(t):e.get(t)),ht=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Q=(t,e,n,r)=>(pt(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function _(){}function Et(t){return t()}function mt(){return Object.create(null)}function j(t){t.forEach(Et)}function kt(t){return typeof t=="function"}function G(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Pt(t){return Object.keys(t).length===0}function qt(t,...e){if(t==null){for(const r of e)r(void 0);return _}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function It(t,e,n){t.$$.on_destroy.push(qt(e,n))}function f(t,e){t.appendChild(e)}function V(t,e,n){t.insertBefore(e,n||null)}function N(t){t.parentNode&&t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function S(t){return document.createTextNode(t)}function v(){return S(" ")}function I(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function a(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Lt(t){return t===""?null:+t}function Rt(t){return Array.from(t.childNodes)}function zt(t,e){e=""+e,t.data!==e&&(t.data=e)}function P(t,e){t.value=e??""}function Xt(t,e,n,r){t.style.setProperty(e,n,"")}let B;function D(t){B=t}function Yt(){if(!B)throw new Error("Function called outside component initialization");return B}function Vt(t){Yt().$$.on_mount.push(t)}const F=[],_t=[];let O=[];const gt=[],Gt=Promise.resolve();let nt=!1;function Ht(){nt||(nt=!0,Gt.then(Ct))}function rt(t){O.push(t)}const Z=new Set;let L=0;function Ct(){if(L!==0)return;const t=B;do{try{for(;L<F.length;){const e=F[L];L++,D(e),Kt(e.$$)}}catch(e){throw F.length=0,L=0,e}for(D(null),F.length=0,L=0;_t.length;)_t.pop()();for(let e=0;e<O.length;e+=1){const n=O[e];Z.has(n)||(Z.add(n),n())}O.length=0}while(F.length);for(;gt.length;)gt.pop()();nt=!1,Z.clear(),D(t)}function Kt(t){if(t.fragment!==null){t.update(),j(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(rt)}}function Ut(t){const e=[],n=[];O.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),O=e}const X=new Set;let Wt;function it(t,e){t&&t.i&&(X.delete(t),t.i(e))}function bt(t,e,n,r){if(t&&t.o){if(X.has(t))return;X.add(t),Wt.c.push(()=>{X.delete(t)}),t.o(e)}}function $t(t){t&&t.c()}function st(t,e,n){const{fragment:r,after_update:i}=t.$$;r&&r.m(e,n),rt(()=>{const s=t.$$.on_mount.map(Et).filter(kt);t.$$.on_destroy?t.$$.on_destroy.push(...s):j(s),t.$$.on_mount=[]}),i.forEach(rt)}function ot(t,e){const n=t.$$;n.fragment!==null&&(Ut(n.after_update),j(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Jt(t,e){t.$$.dirty[0]===-1&&(F.push(t),Ht(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ut(t,e,n,r,i,s,u=null,l=[-1]){const c=B;D(t);const o=t.$$={fragment:null,ctx:[],props:s,update:_,not_equal:i,bound:mt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:mt(),dirty:l,skip_bound:!1,root:e.target||c.$$.root};u&&u(o.root);let d=!1;if(o.ctx=n?n(t,e.props||{},(m,b,...w)=>{const g=w.length?w[0]:b;return o.ctx&&i(o.ctx[m],o.ctx[m]=g)&&(!o.skip_bound&&o.bound[m]&&o.bound[m](g),d&&Jt(t,m)),b}):[],o.update(),d=!0,j(o.before_update),o.fragment=r?r(o.ctx):!1,e.target){if(e.hydrate){const m=Rt(e.target);o.fragment&&o.fragment.l(m),m.forEach(N)}else o.fragment&&o.fragment.c();e.intro&&it(t.$$.fragment),st(t,e.target,e.anchor),Ct()}D(c)}class ct{constructor(){W(this,"$$");W(this,"$$set")}$destroy(){ot(this,1),this.$destroy=_}$on(e,n){if(!kt(n))return _;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!Pt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Qt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Qt);class H{withFields(e){let n=Object.keys(this).map(r=>r in e?e[r]:this[r]);return new this.constructor(...n)}}class lt{static fromArray(e,n){let r=n||new Ft;for(let i=e.length-1;i>=0;--i)r=new Tt(e[i],r);return r}[Symbol.iterator](){return new te(this)}toArray(){return[...this]}atLeastLength(e){for(let n of this){if(e<=0)return!0;e--}return e<=0}hasLength(e){for(let n of this){if(e<=0)return!1;e--}return e===0}countLength(){let e=0;for(let n of this)e++;return e}}function tt(t,e){return new Tt(t,e)}function Zt(t,e){return lt.fromArray(t,e)}var E;class te{constructor(e){ht(this,E,void 0);Q(this,E,e)}next(){if(J(this,E)instanceof Ft)return{done:!0};{let{head:e,tail:n}=J(this,E);return Q(this,E,n),{value:e,done:!1}}}}E=new WeakMap;class Ft extends lt{}class Tt extends lt{constructor(e,n){super(),this.head=e,this.tail=n}}class K extends H{static isResult(e){return e instanceof K}}class ee extends K{constructor(e){super(),this[0]=e}isOk(){return!0}}let ne=class extends K{constructor(e){super(),this[0]=e}isOk(){return!1}};function re(t,e){return t%e}function ie(t,e){return Math.trunc(se(t,e))}function se(t,e){return t/e}class oe extends H{}class St extends H{}class Ot extends H{}function ue(t){return t}function wt(t,e){let r=ue(t);return At(r,e)}function ce(t,e){return t===e?new St:t<e?new oe:new Ot}function yt(t,e,n){for(;;){let r=t,i=e,s=n;if(r.hasLength(0))return i;{let u=r.head;t=r.tail,e=s(i,u),n=s}}}function le(t,e,n){for(;;){let r=t,i=e,s=n,u=ce(r,i);if(u instanceof St)return tt(i,s);u instanceof Ot?(t=r,e=i+1,n=tt(i,s)):(t=r,e=i-1,n=tt(i,s))}}function xt(t,e){return le(t,e,Zt([]))}function et(t,e){return t.isOk()?t[0]:e}function ae(t){return Math.ceil(t)}function vt(t){return Math.round(t)}function fe(t,e){return Math.pow(t,e)}function de(t){return ae(t)}function At(t,e){let n=de(e)-e>0;return t<0&&n||t===0&&e<0?new ne(void 0):new ee(fe(t,e))}function pe(t){return At(t,.5)}function he(t){return-1*t}function me(t){return t>=0?vt(t):0-vt(he(t))}function _e(t){return me(t)}const ge=640,be=480;function q(t,e){const n=t.data,r=e*4;return n[r]<<24|n[r+1]<<16|n[r+2]<<8|n[r+3]}function T(t,e,n){const r=e*4,i=t.data;return i[r]=n>>24&255,i[r+1]=n>>16&255,i[r+2]=n>>8&255,i[r+3]=n&255,t}function $e(t){const n=document.getElementById("canvas").getContext("2d"),r=n.getImageData(0,0,ge,be),i=t(r);n.putImageData(i,0,0)}const $=640;function Mt(t,e,n,r){return T(t,n*$+e,r)}const we=480;function ye(t,e,n,r,i){let s=xt(-1*r,r);return yt(s,t,(u,l)=>{let c=xt(-1*r,r);return yt(c,u,(o,d)=>(()=>{let w=pe((()=>{let k=wt(d,2);return et(k,0)})()+(()=>{let k=wt(l,2);return et(k,0)})()),g=et(w,0);return _e(g)})()>r?o:Mt(o,e+d,n+l,i))})}const xe=479;function ve(t,e){let n=re(e,$),r=ie(e,$);if(r===xe)return t;{let s=q(t,e),u=q(t,e+$),l=q(t,e+$-1),c=q(t,e+$+1);if(s===0)return t;if(u===0){let d=Mt(t,n,r+1,s);return T(d,e,0)}else if(l===0&&n>0){let d=T(t,e+$-1,s);return T(d,e,0)}else if(c===0&&n<639){let d=T(t,e+$+1,s);return T(d,e,0)}else return t}}function Ee(t,e){for(;;){let n=t,r=e;if(r===-1)return n;t=ve(n,r),e=r-1}}function ke(t,e,n,r,i){return $e(s=>{let l=t?ye(s,e,n,r,i):s;return Ee(l,we*$)})}const C=[];function Dt(t,e=_){let n;const r=new Set;function i(l){if(G(t,l)&&(t=l,n)){const c=!C.length;for(const o of r)o[1](),C.push(o,t);if(c){for(let o=0;o<C.length;o+=2)C[o][0](C[o+1]);C.length=0}}}function s(l){i(l(t))}function u(l,c=_){const o=[l,c];return r.add(o),r.size===1&&(n=e(i,s)||_),l(t),()=>{r.delete(o),r.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:u}}const R=1,p={lastFrameTime:performance.now(),currentFrameTime:performance.now(),mouseDown:!1,mouseX:0,mouseY:0},Nt=Dt(p),Y={brushSize:10,brushColour:"#ff0000",autoTick:!0},z=Dt(Y);function at(){ke(p.mouseDown,p.mouseX,p.mouseY,Y.brushSize,parseInt(Y.brushColour.substring(1),16)<<8|255),p.currentFrameTime=performance.now(),Nt.update(()=>({...p})),p.lastFrameTime=p.currentFrameTime,Y.autoTick&&requestAnimationFrame(at)}function Ie(){const t=document.getElementById("canvas");t.addEventListener("mousedown",e=>{p.mouseDown=!0,p.mouseX=Math.trunc(e.offsetX/R),p.mouseY=Math.trunc(e.offsetY/R)}),t.addEventListener("mouseup",()=>{p.mouseDown=!1}),t.addEventListener("mousemove",e=>{p.mouseX=Math.trunc(e.offsetX/R),p.mouseY=Math.trunc(e.offsetY/R)}),requestAnimationFrame(at)}function Le(t){let e,n,r,i,s,u,l,c,o,d,m,b,w,g,k,x,ft,A,U,dt;return{c(){e=h("div"),n=h("label"),r=S(`Brush size:
        `),i=h("input"),s=v(),u=h("label"),l=S(`Brush colour:
        `),c=h("input"),o=v(),d=h("button"),d.textContent="Insert noise",m=v(),b=h("button"),b.textContent="Clear canvas",w=v(),g=h("label"),k=S(`Auto tick:
        `),x=h("input"),ft=v(),A=h("button"),A.textContent="Tick frame",a(i,"class","rounded-md bg-slate-900 p-2 outline-none ring-teal-600 transition-all focus:ring-2"),a(i,"type","number"),a(i,"min","0"),a(i,"max","50"),a(i,"step","1"),a(n,"class","flex flex-row items-center justify-between"),a(c,"class","rounded-md bg-slate-900 p-2 outline-none ring-teal-600 transition-all focus:ring-2"),a(c,"type","color"),a(u,"class","flex flex-row items-center justify-between"),a(d,"class","rounded-md bg-teal-600 p-2 transition-colors hover:bg-teal-700"),a(b,"class","rounded-md bg-teal-600 p-2 transition-colors hover:bg-teal-700"),a(x,"class","rounded-md bg-slate-900 p-2 outline-none ring-teal-600 transition-all focus:ring-2"),a(x,"type","checkbox"),a(g,"class","flex flex-row items-center justify-between"),a(A,"class","rounded-md bg-teal-600 p-2 transition-colors hover:bg-teal-700"),a(e,"class","grid grid-cols-2 gap-2 rounded-b-lg bg-slate-950 p-4")},m(y,M){V(y,e,M),f(e,n),f(n,r),f(n,i),P(i,t[0].brushSize),f(e,s),f(e,u),f(u,l),f(u,c),P(c,t[0].brushColour),f(e,o),f(e,d),f(e,m),f(e,b),f(e,w),f(e,g),f(g,k),f(g,x),x.checked=t[0].autoTick,f(e,ft),f(e,A),U||(dt=[I(i,"input",t[1]),I(c,"input",t[2]),I(d,"click",Ce),I(b,"click",Fe),I(x,"change",t[3]),I(A,"click",at)],U=!0)},p(y,[M]){M&1&&Lt(i.value)!==y[0].brushSize&&P(i,y[0].brushSize),M&1&&P(c,y[0].brushColour),M&1&&(x.checked=y[0].autoTick)},i:_,o:_,d(y){y&&N(e),U=!1,j(dt)}}}function Ce(){const t=document.getElementById("canvas"),e=t.getContext("2d"),n=e.getImageData(0,0,t.width,t.height),r=[[255,0,0,0],[0,255,0],[0,0,255]];for(let i=0;i<n.data.length;i+=4){if(n.data[i+3])continue;const[s,u,l]=r[Math.floor(Math.random()*r.length)];n.data[i]=s,n.data[i+1]=u,n.data[i+2]=l,n.data[i+3]=255}e.putImageData(n,0,0)}function Fe(){const t=document.getElementById("canvas");t.getContext("2d").clearRect(0,0,t.width,t.height)}function Te(t,e,n){let r;It(t,z,l=>n(0,r=l));function i(){r.brushSize=Lt(this.value),z.set(r)}function s(){r.brushColour=this.value,z.set(r)}function u(){r.autoTick=this.checked,z.set(r)}return[r,i,s,u]}class Se extends ct{constructor(e){super(),ut(this,e,Te,Le,G,{})}}function Oe(t){let e,n,r;return{c(){e=h("div"),n=S("FPS: "),r=S(t[0]),a(e,"class","absolute bottom-2 right-2 text-slate-500")},m(i,s){V(i,e,s),f(e,n),f(e,r)},p(i,[s]){s&1&&zt(r,i[0])},i:_,o:_,d(i){i&&N(e)}}}const Ae=200;function Me(t,e,n){let r;It(t,Nt,u=>n(2,r=u));let i=0,s=performance.now();return t.$$.update=()=>{if(t.$$.dirty&6){const u=performance.now();u-s>Ae&&(n(1,s=u),n(0,i=Math.trunc(1e3/(r.currentFrameTime-r.lastFrameTime))))}},[i,s,r]}class De extends ct{constructor(e){super(),ut(this,e,Me,Oe,G,{})}}function Ne(t){let e,n,r,i,s,u,l;return i=new Se({}),u=new De({}),{c(){e=h("div"),n=h("canvas"),r=v(),$t(i.$$.fragment),s=v(),$t(u.$$.fragment),a(n,"class","scale h-[480px] w-full bg-black bg-opacity-25"),Xt(n,"image-rendering","pixelated"),a(n,"id","canvas"),a(n,"width","640"),a(n,"height","480"),a(e,"class","w-[640px]")},m(c,o){V(c,e,o),f(e,n),f(e,r),st(i,e,null),V(c,s,o),st(u,c,o),l=!0},p:_,i(c){l||(it(i.$$.fragment,c),it(u.$$.fragment,c),l=!0)},o(c){bt(i.$$.fragment,c),bt(u.$$.fragment,c),l=!1},d(c){c&&(N(e),N(s)),ot(i),ot(u,c)}}}function Be(t){return Vt(()=>{Ie()}),[]}class je extends ct{constructor(e){super(),ut(this,e,Be,Ne,G,{})}}new je({target:document.getElementById("app")});
