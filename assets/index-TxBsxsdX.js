var ke=Object.defineProperty;var De=(e,t,n)=>t in e?ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var X=(e,t,n)=>(De(e,typeof t!="symbol"?t+"":t,n),n),ue=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var Y=(e,t,n)=>(ue(e,t,"read from private field"),n?n.call(e):t.get(e)),oe=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},z=(e,t,n,r)=>(ue(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function m(){}function $e(e){return e()}function ce(){return Object.create(null)}function A(e){e.forEach($e)}function be(e){return typeof e=="function"}function P(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Ne(e){return Object.keys(e).length===0}function Pe(e,...t){if(e==null){for(const r of t)r(void 0);return m}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function we(e,t,n){e.$$.on_destroy.push(Pe(t,n))}function _(e,t){e.appendChild(t)}function N(e,t,n){e.insertBefore(t,n||null)}function S(e){e.parentNode&&e.parentNode.removeChild(e)}function $(e){return document.createElement(e)}function M(e){return document.createTextNode(e)}function K(){return M(" ")}function le(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function f(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ye(e){return e===""?null:+e}function je(e){return Array.from(e.childNodes)}function qe(e,t){t=""+t,e.data!==t&&(e.data=t)}function T(e,t){e.value=t??""}function Be(e,t,n,r){e.style.setProperty(t,n,"")}let O;function F(e){O=e}function Xe(){if(!O)throw new Error("Function called outside component initialization");return O}function Ye(e){Xe().$$.on_mount.push(e)}const x=[],ae=[];let I=[];const fe=[],ze=Promise.resolve();let U=!1;function Re(){U||(U=!0,ze.then(xe))}function W(e){I.push(e)}const R=new Set;let w=0;function xe(){if(w!==0)return;const e=O;do{try{for(;w<x.length;){const t=x[w];w++,F(t),Ve(t.$$)}}catch(t){throw x.length=0,w=0,t}for(F(null),x.length=0,w=0;ae.length;)ae.pop()();for(let t=0;t<I.length;t+=1){const n=I[t];R.has(n)||(R.add(n),n())}I.length=0}while(x.length);for(;fe.length;)fe.pop()();U=!1,R.clear(),F(e)}function Ve(e){if(e.fragment!==null){e.update(),A(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(W)}}function Ge(e){const t=[],n=[];I.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),I=t}const D=new Set;let He;function J(e,t){e&&e.i&&(D.delete(e),e.i(t))}function pe(e,t,n,r){if(e&&e.o){if(D.has(e))return;D.add(e),He.c.push(()=>{D.delete(e)}),e.o(t)}}function de(e){e&&e.c()}function Q(e,t,n){const{fragment:r,after_update:i}=e.$$;r&&r.m(t,n),W(()=>{const s=e.$$.on_mount.map($e).filter(be);e.$$.on_destroy?e.$$.on_destroy.push(...s):A(s),e.$$.on_mount=[]}),i.forEach(W)}function Z(e,t){const n=e.$$;n.fragment!==null&&(Ge(n.after_update),A(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ke(e,t){e.$$.dirty[0]===-1&&(x.push(e),Re(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ne(e,t,n,r,i,s,u=null,l=[-1]){const c=O;F(e);const o=e.$$={fragment:null,ctx:[],props:s,update:m,not_equal:i,bound:ce(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:ce(),dirty:l,skip_bound:!1,root:t.target||c.$$.root};u&&u(o.root);let p=!1;if(o.ctx=n?n(e,t.props||{},(a,g,...L)=>{const C=L.length?L[0]:g;return o.ctx&&i(o.ctx[a],o.ctx[a]=C)&&(!o.skip_bound&&o.bound[a]&&o.bound[a](C),p&&Ke(e,a)),g}):[],o.update(),p=!0,A(o.before_update),o.fragment=r?r(o.ctx):!1,t.target){if(t.hydrate){const a=je(t.target);o.fragment&&o.fragment.l(a),a.forEach(S)}else o.fragment&&o.fragment.c();t.intro&&J(e.$$.fragment),Q(e,t.target,t.anchor),xe()}F(c)}class re{constructor(){X(this,"$$");X(this,"$$set")}$destroy(){Z(this,1),this.$destroy=m}$on(t,n){if(!be(n))return m;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(t){this.$$set&&!Ne(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ue="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ue);class j{withFields(t){let n=Object.keys(this).map(r=>r in t?t[r]:this[r]);return new this.constructor(...n)}}class ie{static fromArray(t,n){let r=n||new ve;for(let i=t.length-1;i>=0;--i)r=new Ee(t[i],r);return r}[Symbol.iterator](){return new Je(this)}toArray(){return[...this]}atLeastLength(t){for(let n of this){if(t<=0)return!0;t--}return t<=0}hasLength(t){for(let n of this){if(t<=0)return!1;t--}return t===0}countLength(){let t=0;for(let n of this)t++;return t}}function V(e,t){return new Ee(e,t)}function We(e,t){return ie.fromArray(e,t)}var b;class Je{constructor(t){oe(this,b,void 0);z(this,b,t)}next(){if(Y(this,b)instanceof ve)return{done:!0};{let{head:t,tail:n}=Y(this,b);return z(this,b,n),{value:t,done:!1}}}}b=new WeakMap;class ve extends ie{}class Ee extends ie{constructor(t,n){super(),this.head=t,this.tail=n}}class q extends j{static isResult(t){return t instanceof q}}class Qe extends q{constructor(t){super(),this[0]=t}isOk(){return!0}}let Ze=class extends q{constructor(t){super(),this[0]=t}isOk(){return!1}};function Ie(e,t){return e%t}function Le(e,t){return Math.trunc(et(e,t))}function et(e,t){return e/t}class tt extends j{}class Fe extends j{}class Se extends j{}function nt(e){return e}function he(e,t){let r=nt(e);return Me(r,t)}function rt(e,t){return e===t?new Fe:e<t?new tt:new Se}function me(e,t,n){for(;;){let r=e,i=t,s=n;if(r.hasLength(0))return i;{let u=r.head;e=r.tail,t=s(i,u),n=s}}}function it(e,t,n){for(;;){let r=e,i=t,s=n,u=rt(r,i);if(u instanceof Fe)return V(i,s);u instanceof Se?(e=r,t=i+1,n=V(i,s)):(e=r,t=i-1,n=V(i,s))}}function _e(e,t){return it(e,t,We([]))}function G(e,t){return e.isOk()?e[0]:t}function st(e){return Math.ceil(e)}function ge(e){return Math.round(e)}function ut(e,t){return Math.pow(e,t)}function ot(e){return st(e)}function Me(e,t){let n=ot(t)-t>0;return e<0&&n||e===0&&t<0?new Ze(void 0):new Qe(ut(e,t))}function ct(e){return Me(e,.5)}function lt(e){return-1*e}function at(e){return e>=0?ge(e):0-ge(lt(e))}function ft(e){return at(e)}const ee=640,Oe=480;function E(e,t){const n=e.data,r=t*4;return n[r]<<24|n[r+1]<<16|n[r+2]<<8|n[r+3]}function v(e,t,n){const r=t*4,i=e.data;return i[r]=n>>24&255,i[r+1]=n>>16&255,i[r+2]=n>>8&255,i[r+3]=n&255,e}function pt(e){const n=document.getElementById("canvas").getContext("2d"),r=n.getImageData(0,0,ee,Oe),i=e(r);n.putImageData(i,0,0)}function dt(e,t,n,r){let i=0;for(let s=-1;s<=1;s++){for(let u=-1;u<=1;u++){const l=t+s,c=n+u;l<0||l>=ee||c<0||c>=Oe||r(E(e,c*ee+l))&&i++}return i}}const h=640;function ht(e,t,n){return E(e,n*h+t)}function se(e,t,n,r){return v(e,n*h+t,r)}const mt=480;function _t(e,t){let n=Ie(t,h),r=Le(t,h),i=ht(e,n,r);return i===0||dt(e,n,r,l=>i===l)===0?e:se(e,n,r,0)}function gt(e,t,n,r,i){let s=_e(-1*r,r);return me(s,e,(u,l)=>{let c=_e(-1*r,r);return me(c,u,(o,p)=>(()=>{let L=ct((()=>{let B=he(p,2);return G(B,0)})()+(()=>{let B=he(l,2);return G(B,0)})()),C=G(L,0);return ft(C)})()>r?o:se(o,t+p,n+l,i))})}const $t=479;function bt(e,t){let n=Ie(t,h),r=Le(t,h);if(r===$t)return e;{let s=E(e,t),u=E(e,t+h),l=E(e,t+h-1),c=E(e,t+h+1);if(s===0)return e;if(u===0){let p=se(e,n,r+1,s);return v(p,t,0)}else if(l===0&&n>0){let p=v(e,t+h-1,s);return v(p,t,0)}else if(c===0&&n<639){let p=v(e,t+h+1,s);return v(p,t,0)}else return e}}function wt(e,t){for(;;){let n=e,r=t;if(r===-1)return n;e=(()=>{let u=bt(n,r);return _t(u,r)})(),t=r-1}}function yt(e,t,n,r,i){return pt(s=>{let l=e?gt(s,t,n,r,i):s;return wt(l,mt*h)})}const y=[];function Ae(e,t=m){let n;const r=new Set;function i(l){if(P(e,l)&&(e=l,n)){const c=!y.length;for(const o of r)o[1](),y.push(o,e);if(c){for(let o=0;o<y.length;o+=2)y[o][0](y[o+1]);y.length=0}}}function s(l){i(l(e))}function u(l,c=m){const o=[l,c];return r.add(o),r.size===1&&(n=t(i,s)||m),l(e),()=>{r.delete(o),r.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:u}}const k=1,d={lastFrameTime:performance.now(),currentFrameTime:performance.now(),mouseDown:!1,mouseX:0,mouseY:0},Ce=Ae(d),te={brushSize:10,brushColour:"#ff0000"},H=Ae(te);function Te(){yt(d.mouseDown,d.mouseX,d.mouseY,te.brushSize,parseInt(te.brushColour.substring(1),16)<<8|255),d.currentFrameTime=performance.now(),Ce.update(()=>({...d})),d.lastFrameTime=d.currentFrameTime,requestAnimationFrame(Te)}function xt(){const e=document.getElementById("canvas"),t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=[[255,0,0,0],[0,255,0],[0,0,255]];for(let i=0;i<n.data.length;i+=4){const[s,u,l]=r[Math.floor(Math.random()*r.length)];n.data[i]=s,n.data[i+1]=u,n.data[i+2]=l,n.data[i+3]=255}t.putImageData(n,0,0),e.addEventListener("mousedown",i=>{d.mouseDown=!0,d.mouseX=Math.trunc(i.offsetX/k),d.mouseY=Math.trunc(i.offsetY/k)}),e.addEventListener("mouseup",()=>{d.mouseDown=!1}),e.addEventListener("mousemove",i=>{d.mouseX=Math.trunc(i.offsetX/k),d.mouseY=Math.trunc(i.offsetY/k)}),requestAnimationFrame(Te)}function vt(e){let t,n,r,i,s,u,l,c,o,p;return{c(){t=$("div"),n=$("label"),r=M(`Brush size:
        `),i=$("input"),s=K(),u=$("label"),l=M(`Brush colour:
        `),c=$("input"),f(i,"class","rounded-md bg-slate-900 p-2 outline-none ring-teal-600 transition-all focus:ring-2"),f(i,"type","number"),f(i,"min","0"),f(i,"max","50"),f(i,"step","1"),f(n,"class","flex flex-row items-center justify-between"),f(c,"class","rounded-md bg-slate-900 p-2 outline-none ring-teal-600 transition-all focus:ring-2"),f(c,"type","color"),f(u,"class","flex flex-row items-center justify-between"),f(t,"class","grid grid-cols-2 gap-2 rounded-b-lg bg-slate-950 p-4")},m(a,g){N(a,t,g),_(t,n),_(n,r),_(n,i),T(i,e[0].brushSize),_(t,s),_(t,u),_(u,l),_(u,c),T(c,e[0].brushColour),o||(p=[le(i,"input",e[1]),le(c,"input",e[2])],o=!0)},p(a,[g]){g&1&&ye(i.value)!==a[0].brushSize&&T(i,a[0].brushSize),g&1&&T(c,a[0].brushColour)},i:m,o:m,d(a){a&&S(t),o=!1,A(p)}}}function Et(e,t,n){let r;we(e,H,u=>n(0,r=u));function i(){r.brushSize=ye(this.value),H.set(r)}function s(){r.brushColour=this.value,H.set(r)}return[r,i,s]}class It extends re{constructor(t){super(),ne(this,t,Et,vt,P,{})}}function Lt(e){let t,n,r;return{c(){t=$("div"),n=M("FPS: "),r=M(e[0]),f(t,"class","absolute bottom-2 right-2 text-slate-500")},m(i,s){N(i,t,s),_(t,n),_(t,r)},p(i,[s]){s&1&&qe(r,i[0])},i:m,o:m,d(i){i&&S(t)}}}const Ft=200;function St(e,t,n){let r;we(e,Ce,u=>n(2,r=u));let i=0,s=performance.now();return e.$$.update=()=>{if(e.$$.dirty&6){const u=performance.now();u-s>Ft&&(n(1,s=u),n(0,i=Math.trunc(1e3/(r.currentFrameTime-r.lastFrameTime))))}},[i,s,r]}class Mt extends re{constructor(t){super(),ne(this,t,St,Lt,P,{})}}function Ot(e){let t,n,r,i,s,u,l;return i=new It({}),u=new Mt({}),{c(){t=$("div"),n=$("canvas"),r=K(),de(i.$$.fragment),s=K(),de(u.$$.fragment),f(n,"class","scale h-[480px] w-full bg-black bg-opacity-25"),Be(n,"image-rendering","pixelated"),f(n,"id","canvas"),f(n,"width","640"),f(n,"height","480"),f(t,"class","w-[640px]")},m(c,o){N(c,t,o),_(t,n),_(t,r),Q(i,t,null),N(c,s,o),Q(u,c,o),l=!0},p:m,i(c){l||(J(i.$$.fragment,c),J(u.$$.fragment,c),l=!0)},o(c){pe(i.$$.fragment,c),pe(u.$$.fragment,c),l=!1},d(c){c&&(S(t),S(s)),Z(i),Z(u,c)}}}function At(e){return Ye(()=>{xt()}),[]}class Ct extends re{constructor(t){super(),ne(this,t,At,Ot,P,{})}}new Ct({target:document.getElementById("app")});
